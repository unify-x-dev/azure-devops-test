{
	"appsUsed":[
		
	],
	"createdTime":1744279535164,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1761674860028,
		"deployedBy":0,
		"deployedDefinitionId":"6901066bcb9893140dafaf49",
		"status":"DEPLOYED",
		"version":88,
		"workflowVersion":139
	},
	"edges":[
		{
			"fromNodeId":"DmUVm",
			"priority":0,
			"skip":false,
			"toNodeId":"3HAZb",
			"type":"next"
		},
		{
			"fromNodeId":"3HAZb",
			"priority":0,
			"skip":false,
			"toNodeId":"lXzK1",
			"type":"next"
		},
		{
			"fromNodeId":"lXzK1",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"WMnBv",
			"type":"if"
		},
		{
			"fromNodeId":"lXzK1",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"BctFX",
			"type":"next"
		},
		{
			"fromNodeId":"BctFX",
			"priority":0,
			"skip":false,
			"toNodeId":"n_E9eXV",
			"type":"next"
		},
		{
			"fromNodeId":"n_E9eXV",
			"priority":0,
			"skip":false,
			"toNodeId":"AdOOF",
			"type":"next"
		},
		{
			"fromNodeId":"AdOOF",
			"priority":0,
			"skip":false,
			"toNodeId":"3SFqV",
			"type":"next"
		},
		{
			"fromNodeId":"WMnBv",
			"priority":0,
			"skip":false,
			"toNodeId":"2YHsR",
			"type":"next"
		},
		{
			"fromNodeId":"3SFqV",
			"priority":0,
			"skip":false,
			"toNodeId":"2YHsR",
			"type":"next"
		},
		{
			"fromNodeId":"2YHsR",
			"priority":0,
			"skip":false,
			"toNodeId":"qbAQa",
			"type":"next"
		}
	],
	"grants":{
		"configs":[
			{
				"permissions":[
					"V"
				],
				"principalType":"GLOBAL"
			}
		]
	},
	"id":"67e15b8cceafcd5e8ff510ca",
	"lastModifiedBy":0,
	"lcName":"eval | metrics | test metric",
	"modifiedTime":1761722732235,
	"name":"Eval | Metrics | Test metric",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceVersion":160,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"2WH2d-1",
			"id":"DmUVm",
			"index":1,
			"inputs":{
				"result":{
					"type":"object",
					"properties":{
						"score":{
							"type":"string",
							"title":"Score"
						},
						"reason":{
							"type":"string",
							"title":"Reason"
						},
						"Result":{
							"type":"boolean",
							"title":"Result"
						}
					},
					"additionalProperties":false,
					"required":[
						"score",
						"reason",
						"Result"
					],
					"dynamic":true
				},
				"setup":{
					"type":"object",
					"properties":{
						"payload":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Payload"
						},
						"metricConfig":{
							"title":"Config",
							"type":"object",
							"additionalProperties":false,
							"properties":{
								"evaluationParameters":{
									"type":"array",
									"items":{
										"type":"string"
									},
									"title":"Evaluation Parameters",
									"searchable":false,
									"sortable":false,
									"filterable":false,
									"primaryKey":false,
									"nameField":false
								},
								"metricConfigId":{
									"type":"string",
									"title":"Metric Config Id",
									"searchable":false,
									"sortable":false,
									"filterable":false,
									"primaryKey":false,
									"nameField":false
								},
								"type":{
									"type":"string",
									"format":"single-select",
									"title":"Type",
									"oneOf":[
										{
											"const":"AI",
											"title":"AI"
										},
										{
											"const":"PROGRAMMATIC",
											"title":"PROGRAMMATIC"
										},
										{
											"const":"Automation",
											"title":"AUTOMATION"
										},
										{
											"const":"Human In The Loop",
											"title":"HUMAN_IN_THE_LOOP"
										}
									],
									"searchable":false,
									"sortable":false,
									"filterable":false,
									"primaryKey":false,
									"nameField":false
								},
								"testCaseType":{
									"type":"string",
									"format":"single-select",
									"title":"Test Case Type",
									"oneOf":[
										{
											"const":"LLM",
											"title":"LLM"
										},
										{
											"const":"conv",
											"title":"CONV"
										}
									],
									"searchable":false,
									"sortable":false,
									"filterable":false,
									"primaryKey":false,
									"nameField":false
								},
								"testCaseSuccessCriteria":{
									"type":"object",
									"properties":{
										"op":{
											"type":"string",
											"title":"op"
										},
										"field":{
											"type":"string",
											"title":"field"
										},
										"values":{
											"type":"array",
											"items":{
												"type":"string"
											},
											"title":"values"
										}
									},
									"additionalProperties":false
								},
								"metricSuccessCriteria":{
									"type":"object",
									"properties":{
										"op":{
											"type":"string",
											"title":"op"
										},
										"field":{
											"type":"string",
											"title":"field"
										},
										"values":{
											"type":"array",
											"items":{
												"type":"string"
											},
											"title":"values"
										}
									},
									"additionalProperties":false
								},
								"evaluationScale":{
									"type":"array",
									"items":{
										"type":"number"
									},
									"title":"Evaluation Scale",
									"searchable":false,
									"sortable":false,
									"filterable":false,
									"primaryKey":false,
									"nameField":false
								},
								"evaluationType":{
									"type":"string",
									"title":"Evaluation Type",
									"searchable":false,
									"sortable":false,
									"filterable":true,
									"primaryKey":false,
									"nameField":false
								},
								"metricConfig":{
									"type":"object",
									"properties":{
										"automationId":{
											"type":"string",
											"title":"Automation Id",
											"searchable":false,
											"sortable":false,
											"filterable":false,
											"primaryKey":false,
											"nameField":false
										},
										"evaluationCriteria":{
											"type":"string",
											"title":"Evaluation Criteria",
											"searchable":false,
											"sortable":false,
											"filterable":false,
											"primaryKey":false,
											"nameField":false
										},
										"evaluationSteps":{
											"type":"array",
											"items":{
												"type":"string"
											},
											"title":"Evaluation Steps",
											"searchable":false,
											"sortable":false,
											"filterable":false,
											"primaryKey":false,
											"nameField":false
										},
										"model":{
											"type":"string",
											"title":"Model",
											"searchable":false,
											"sortable":false,
											"filterable":false,
											"primaryKey":false,
											"nameField":false
										},
										"code":{
											"type":"string",
											"title":"Code",
											"searchable":false,
											"sortable":false,
											"filterable":false,
											"primaryKey":false,
											"nameField":false
										},
										"language":{
											"type":"string",
											"title":"Language",
											"searchable":false,
											"sortable":false,
											"filterable":false,
											"primaryKey":false,
											"nameField":false
										}
									},
									"additionalProperties":true,
									"title":"Metric Config",
									"searchable":false,
									"sortable":false,
									"filterable":false,
									"primaryKey":false,
									"nameField":false,
									"required":[]
								}
							},
							"required":[]
						},
						"HITLAnnotation":{
							"type":"object",
							"properties":{
								"score":{
									"type":"number",
									"title":"Score"
								},
								"reason":{
									"type":"string",
									"title":"Reason"
								}
							},
							"additionalProperties":false,
							"title":"HITL Annotation",
							"required":[
								"score"
							]
						}
					},
					"additionalProperties":false,
					"required":[
						"payload",
						"metricConfig",
						"HITLAnnotation"
					]
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger via automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":186,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"2WH2d-1",
			"id":"3HAZb",
			"index":2,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"score":{
							"type":"number",
							"title":"Score"
						},
						"reason":{
							"type":"string",
							"title":"Reason"
						}
					},
					"required":[]
				}
			},
			"inputs":{
				"score":0
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"score":{
							"type":"number",
							"title":"Score"
						},
						"reason":{
							"type":"string",
							"title":"Reason"
						},
						"_ua_variableDetails":{
							"items":{
								"type":"object",
								"properties":{
									"name":{
										"type":"string",
										"description":"Name of the variable"
									},
									"dataType":{
										"type":"string",
										"description":"Data type of the variable"
									},
									"description":{
										"type":"string",
										"description":"Description of the variable"
									}
								}
							},
							"title":"Variable Details",
							"type":"array"
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":183,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"2WH2d-1",
			"id":"lXzK1",
			"index":3,
			"inputs":{
				"filters":[
					{
						"property":"{{ DmUVm.outputs.metricConfig.type }}",
						"filter":{
							"operator":"EQUAL",
							"value":"HUMAN_IN_THE_LOOP"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":185,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"lXzK1@2WH2d-1@y",
			"id":"WMnBv",
			"index":4,
			"inputs":{
				"variables":[
					{
						"source":"{{ 3HAZb.outputs.score }}",
						"value":"{{ DmUVm.outputs.HITLAnnotation.score }}"
					},
					{
						"source":"{{ 3HAZb.outputs.reason }}",
						"value":"{{ DmUVm.outputs.HITLAnnotation.reason }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"utility_by_unifyapps",
				"resourceVersion":566,
				"resourceName":"utility_by_unifyapps_to_json_string",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"lXzK1@2WH2d-1@n",
			"id":"BctFX",
			"index":5,
			"inputs":{
				"object":"{{ DmUVm.outputs.payload }}"
			},
			"skip":false,
			"subTitle":"Utility by UnifyApps",
			"title":"Serialise object to JSON string",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.parameters.evaluationScale.items"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":803,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"lXzK1@2WH2d-1@n",
			"id":"n_E9eXV",
			"index":6,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"updatedEvaluationScale":{
							"type":"array",
							"items":{
								"type":"integer"
							},
							"title":"Updated Evaluation Scale"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"evaluationScale":{
							"type":"array",
							"items":{
								"type":"integer"
							},
							"title":"Evaluation Scale"
						},
						"evaluationType":{
							"type":"string",
							"title":"Evaluation Type"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"def evaluationType = binding.hasVariable('evaluationType') ? evaluationType : \"SCALE\"\n\ndef evaluationScale = binding.hasVariable('evaluationScale') ? evaluationScale : [0, 10];\n\nif (evaluationType == \"BINARY\")\n{\n  evaluationScale = [0,1];\n}\n\nreturn [\"updatedEvaluationScale\" : evaluationScale]",
				"parameters":{
					"evaluationScale":{
						"source":"{{ DmUVm.outputs.metricConfig.evaluationScale }}",
						"ua:type":"mappedArray",
						"items":"{{ DmUVm.outputs.metricConfig.evaluationScale[0] }}"
					},
					"evaluationType":"{{ DmUVm.outputs.metricConfig.evaluationType }}"
				}
			},
			"skip":false,
			"subTitle":"Code",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"ai_evaluator_by_unifyapps",
				"resourceVersion":7,
				"resourceName":"ai_evaluator_by_unifyapps_evaluate_metric",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"lXzK1@2WH2d-1@n",
			"id":"AdOOF",
			"index":7,
			"inputs":{
				"callableInterfaceId":"__ua__evaluate_metric_interface",
				"parameters":{
					"metricConfig":{
						"evaluationParameters":{
							"source":"{{ DmUVm.outputs.metricConfig.evaluationParameters }}",
							"ua:type":"mappedArray",
							"items":"{{ DmUVm.outputs.metricConfig.evaluationParameters[0] }}"
						},
						"metricConfigId":"{{ DmUVm.outputs.metricConfig.metricConfigId }}",
						"type":"{{ DmUVm.outputs.metricConfig.type }}",
						"testCaseType":"{{ DmUVm.outputs.metricConfig.testCaseType }}",
						"testCaseSuccessCriteria":{},
						"metricSuccessCriteria":{
							"op":"{{ DmUVm.outputs.metricConfig.metricSuccessCriteria.op }}",
							"field":"{{ DmUVm.outputs.metricConfig.metricSuccessCriteria.field }}",
							"values":{
								"source":"{{ DmUVm.outputs.metricConfig.metricSuccessCriteria.values }}",
								"ua:type":"mappedArray",
								"items":"{{ DmUVm.outputs.metricConfig.metricSuccessCriteria.values[0] }}"
							}
						},
						"evaluationType":"{{ DmUVm.outputs.metricConfig.evaluationType }}",
						"metricConfig":{
							"automationId":"{{ DmUVm.outputs.metricConfig.metricConfig.automationId }}",
							"evaluationCriteria":"{{ DmUVm.outputs.metricConfig.metricConfig.evaluationCriteria }}",
							"evaluationSteps":{
								"source":"{{ DmUVm.outputs.metricConfig.metricConfig.evaluationSteps }}",
								"ua:type":"mappedArray",
								"items":"{{ DmUVm.outputs.metricConfig.metricConfig.evaluationSteps[0] }}"
							},
							"model":"{{ DmUVm.outputs.metricConfig.metricConfig.model }}",
							"code":"{{ DmUVm.outputs.metricConfig.metricConfig.code }}",
							"language":"{{ DmUVm.outputs.metricConfig.metricConfig.language }}"
						},
						"evaluationScale":{
							"source":"{{ n_E9eXV.outputs.result.updatedEvaluationScale }}",
							"ua:type":"mappedArray",
							"items":"{{ n_E9eXV.outputs.result.updatedEvaluationScale[0] }}"
						}
					},
					"testCasePayload":"{{ BctFX.outputs.result }}"
				}
			},
			"skip":false,
			"subTitle":"AI Evaluator by UnifyApps",
			"title":"Evaluate Metric",
			"type":"CALL_INTERFACE_WORKFLOW"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":185,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"lXzK1@2WH2d-1@n",
			"id":"3SFqV",
			"index":8,
			"inputs":{
				"variables":[
					{
						"source":"{{ 3HAZb.outputs.score }}",
						"value":"{{ AdOOF.outputs.score }}"
					},
					{
						"source":"{{ 3HAZb.outputs.reason }}",
						"value":"{{ AdOOF.outputs.reason }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":161,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"2WH2d-1",
			"id":"2YHsR",
			"index":9,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"result":{
							"type":"boolean",
							"title":"Result"
						},
						"score":{
							"type":"string",
							"title":"Score"
						}
					},
					"additionalProperties":false,
					"required":[
						"result",
						"score"
					]
				},
				"input":{
					"type":"object",
					"properties":{
						"score":{
							"type":"number",
							"title":"Score"
						},
						"threshold":{
							"type":"number",
							"title":"Threshold"
						},
						"condition":{
							"type":"string",
							"title":"Condition"
						},
						"scale":{
							"type":"array",
							"items":{
								"type":"number"
							},
							"title":"Scale"
						},
						"evaluationType":{
							"type":"string",
							"title":"Evaluation Type"
						}
					},
					"additionalProperties":false,
					"required":[
						"score",
						"threshold",
						"condition",
						"scale",
						"evaluationType"
					]
				},
				"compile_static":false,
				"code":"def matchCriteria(score, threshold, condition) {\n    switch (condition) {\n        case \"EQUAL\":\n            return score == threshold\n        case \"NOT_EQUAL\":\n            return score != threshold\n        case \"LT\":\n            return score < threshold\n        case \"LTE\":\n            return score <= threshold\n        case \"GT\":\n            return score > threshold\n        case \"GTE\":\n            return score >= threshold\n        default:\n            throw new IllegalArgumentException(\"Unsupported condition: $condition\")\n    }\n}\n\ndef result = false;\ndef scoreString = \"No\"\nif (evaluationType == 'BINARY') {\n    scoreString = score > 0 ? 'Yes' : 'No'\n    result = matchCriteria((score > 0 ? true : false), threshold, condition);\n\n} else {\n    scoreString = score + '/' + scale.get(1)\n    result = matchCriteria(score, Double.parseDouble(threshold), condition)\n}\nreturn [\"result\": result, 'score' : scoreString]",
				"parameters":{
					"threshold":"{{ DmUVm.outputs.metricConfig.testCaseSuccessCriteria.values[0] }}",
					"condition":"{{ DmUVm.outputs.metricConfig.testCaseSuccessCriteria.op }}",
					"scale":{
						"source":"{{ DmUVm.outputs.metricConfig.evaluationScale }}",
						"ua:type":"mappedArray",
						"items":"{{ DmUVm.outputs.metricConfig.evaluationScale[0] }}"
					},
					"evaluationType":"{{ DmUVm.outputs.metricConfig.evaluationType }}",
					"score":"{{ 3HAZb.outputs.score }}"
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":163,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"2WH2d-1",
			"id":"qbAQa",
			"index":10,
			"inputs":{
				"result":{
					"Result":"{{ 2YHsR.outputs.result.result }}",
					"score":"{{ 2YHsR.outputs.result.score }}",
					"reason":"{{ 3HAZb.outputs.reason }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":-1,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":true,
	"tags":[
		
	],
	"version":141
}