{
	"appsUsed":[
		"storage_by_unifyapps"
	],
	"createdTime":1745765239367,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1760296260780,
		"deployedBy":-1,
		"deployedDefinitionId":"68ebfd44d60dd816d7799082",
		"status":"DEPLOYED",
		"version":76,
		"workflowVersion":130
	},
	"edges":[
		{
			"fromNodeId":"3iNEX",
			"priority":0,
			"skip":false,
			"toNodeId":"KQ4fW",
			"type":"next"
		},
		{
			"fromNodeId":"KQ4fW",
			"priority":0,
			"skip":false,
			"toNodeId":"agC4f",
			"type":"next"
		},
		{
			"fromNodeId":"agC4f",
			"priority":0,
			"skip":false,
			"toNodeId":"3yG5L",
			"type":"next"
		},
		{
			"fromNodeId":"3yG5L",
			"priority":0,
			"skip":false,
			"toNodeId":"puP5M",
			"type":"next"
		},
		{
			"fromNodeId":"puP5M",
			"priority":0,
			"skip":false,
			"toNodeId":"n_Ok027",
			"type":"next"
		},
		{
			"fromNodeId":"n_Ok027",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"njg21",
			"type":"if"
		},
		{
			"fromNodeId":"njg21",
			"priority":0,
			"skip":false,
			"toNodeId":"dFTNb",
			"type":"next"
		},
		{
			"fromNodeId":"dFTNb",
			"priority":0,
			"skip":false,
			"toNodeId":"FW69U",
			"type":"next"
		},
		{
			"fromNodeId":"FW69U",
			"priority":0,
			"skip":false,
			"toNodeId":"uJu1r",
			"type":"loop"
		},
		{
			"fromNodeId":"uJu1r",
			"priority":0,
			"skip":false,
			"toNodeId":"jPSc2",
			"type":"next"
		},
		{
			"fromNodeId":"jPSc2",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"7frlW",
			"type":"if"
		},
		{
			"fromNodeId":"7frlW",
			"priority":0,
			"skip":false,
			"toNodeId":"7nYCD",
			"type":"next"
		},
		{
			"fromNodeId":"7nYCD",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"b7S1e",
			"type":"next"
		},
		{
			"fromNodeId":"7nYCD",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"vUKrY",
			"type":"if"
		},
		{
			"fromNodeId":"b7S1e",
			"priority":0,
			"skip":false,
			"toNodeId":"vUKrY",
			"type":"next"
		},
		{
			"fromNodeId":"vUKrY",
			"name":"loopback",
			"priority":0,
			"skip":false,
			"toNodeId":"FW69U",
			"type":"next"
		},
		{
			"fromNodeId":"jPSc2",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"FW69U",
			"type":"next"
		},
		{
			"fromNodeId":"n_Ok027",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"_6J13W",
			"type":"next"
		},
		{
			"fromNodeId":"_6J13W",
			"priority":0,
			"skip":false,
			"toNodeId":"_WxY0C",
			"type":"next"
		},
		{
			"fromNodeId":"_WxY0C",
			"priority":0,
			"skip":false,
			"toNodeId":"_Fd7f1",
			"type":"next"
		},
		{
			"fromNodeId":"_Fd7f1",
			"priority":0,
			"skip":false,
			"toNodeId":"_x5rTv",
			"type":"loop"
		},
		{
			"fromNodeId":"_x5rTv",
			"priority":0,
			"skip":false,
			"toNodeId":"_MDLtQ",
			"type":"next"
		},
		{
			"fromNodeId":"_MDLtQ",
			"priority":0,
			"skip":false,
			"toNodeId":"_ajleK",
			"type":"next"
		},
		{
			"fromNodeId":"_ajleK",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"_5fPk5",
			"type":"if"
		},
		{
			"fromNodeId":"_5fPk5",
			"priority":0,
			"skip":false,
			"toNodeId":"_5vb49",
			"type":"next"
		},
		{
			"fromNodeId":"_5vb49",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"_6LcRN",
			"type":"next"
		},
		{
			"fromNodeId":"_5vb49",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"_rOX45",
			"type":"if"
		},
		{
			"fromNodeId":"_6LcRN",
			"priority":0,
			"skip":false,
			"toNodeId":"_rOX45",
			"type":"next"
		},
		{
			"fromNodeId":"_rOX45",
			"name":"loopback",
			"priority":0,
			"skip":false,
			"toNodeId":"_Fd7f1",
			"type":"next"
		},
		{
			"fromNodeId":"_ajleK",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"_Fd7f1",
			"type":"next"
		},
		{
			"fromNodeId":"FW69U",
			"priority":0,
			"skip":false,
			"toNodeId":"IzzSw",
			"type":"next"
		},
		{
			"fromNodeId":"_Fd7f1",
			"priority":0,
			"skip":false,
			"toNodeId":"IzzSw",
			"type":"next"
		},
		{
			"fromNodeId":"IzzSw",
			"priority":0,
			"skip":false,
			"toNodeId":"vzNbB",
			"type":"next"
		},
		{
			"fromNodeId":"vzNbB",
			"priority":0,
			"skip":false,
			"toNodeId":"xORbN",
			"type":"next"
		},
		{
			"fromNodeId":"xORbN",
			"priority":0,
			"skip":false,
			"toNodeId":"vBMPP",
			"type":"next"
		},
		{
			"fromNodeId":"vBMPP",
			"priority":0,
			"skip":false,
			"toNodeId":"TU9se",
			"type":"next"
		},
		{
			"fromNodeId":"TU9se",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"XlqC3",
			"type":"if"
		},
		{
			"fromNodeId":"XlqC3",
			"priority":0,
			"skip":false,
			"toNodeId":"UYgSw",
			"type":"next"
		},
		{
			"fromNodeId":"UYgSw",
			"priority":0,
			"skip":false,
			"toNodeId":"GFzTm",
			"type":"next"
		},
		{
			"fromNodeId":"GFzTm",
			"priority":0,
			"skip":false,
			"toNodeId":"7o210",
			"type":"next"
		},
		{
			"fromNodeId":"TU9se",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"7o210",
			"type":"next"
		}
	],
	"grants":{
		"configs":[
			{
				"permissions":[
					"V"
				],
				"principalType":"GLOBAL"
			}
		]
	},
	"id":"680dc2ccd7f69d4b2644de5a",
	"lastModifiedBy":0,
	"lcName":"observability | get case traces info",
	"modifiedTime":1761722808966,
	"name":"Observability | Get Case Traces Info",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceVersion":296,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"vhHXW-1",
			"id":"3iNEX",
			"index":1,
			"inputs":{
				"result":{
					"type":"object",
					"properties":{
						"result":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false,
								"required":[]
							},
							"title":"Result"
						}
					},
					"additionalProperties":false,
					"required":[
						"result"
					]
				},
				"setup":{
					"type":"object",
					"properties":{
						"caseId":{
							"type":"string",
							"title":"caseId"
						}
					},
					"additionalProperties":false,
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger via automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":75,
				"resourceName":"storage_by_unifyapps_fetch_records",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"vhHXW-1",
			"id":"KQ4fW",
			"index":2,
			"inputs":{
				"triggerInputCondition":{
					"filters":[
						{
							"property":"properties_caseId",
							"filter":{
								"operator":"EQUAL",
								"value":"{{ 3iNEX.outputs.caseId }}"
							}
						}
					],
					"operator":"AND"
				},
				"object_type":"service_hub_message",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"sortBy":[
					{
						"field":"cTm",
						"order":"ASC"
					}
				],
				"translationsOption":"DEFAULT",
				"page":{
					"paginateBy":"OFFSET",
					"limit":20
				},
				"numberOfRecordsToFetch":"SINGLE",
				"readThroughSessionVariables":false,
				"includeTotalCount":false
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Fetch records",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":75,
				"resourceName":"storage_by_unifyapps_fetch_records",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"vhHXW-1",
			"id":"agC4f",
			"index":3,
			"inputs":{
				"triggerInputCondition":{
					"filters":[
						{
							"property":"properties_caseId",
							"filter":{
								"operator":"EQUAL",
								"value":"{{ 3iNEX.outputs.caseId }}"
							}
						}
					],
					"operator":"AND"
				},
				"object_type":"service_hub_message",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"sortBy":[
					{
						"field":"cTm",
						"order":"DESC"
					}
				],
				"translationsOption":"DEFAULT",
				"page":{
					"paginateBy":"OFFSET",
					"limit":20
				},
				"numberOfRecordsToFetch":"SINGLE",
				"readThroughSessionVariables":false,
				"includeTotalCount":false
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Fetch records",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":300,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"vhHXW-1",
			"id":"3yG5L",
			"index":4,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"additionalProperties":false,
									"type":[
										"object",
										"string",
										"number",
										"boolean",
										"integer"
									],
									"properties":{
										"traceId":{
											"type":"string",
											"title":"Trace Id"
										},
										"latency":{
											"type":"number",
											"title":"Latency"
										},
										"tokenCost":{
											"type":"number",
											"title":"Token Cost"
										},
										"tokens":{
											"type":"number",
											"title":"Tokens"
										}
									},
									"required":[
										"traceId",
										"latency",
										"tokenCost",
										"tokens"
									]
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray"
				},
				"ua:title":"tracesInfos",
				"ua:list_type":"OBJECT"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"tracesInfos",
							"disableActions":true,
							"items":{
								"type":"object",
								"properties":{
									"traceId":{
										"type":"string",
										"title":"Trace Id"
									},
									"latency":{
										"type":"number",
										"title":"Latency"
									},
									"tokenCost":{
										"type":"number",
										"title":"Token Cost"
									},
									"tokens":{
										"type":"number",
										"title":"Tokens"
									}
								},
								"required":[
									"traceId",
									"latency",
									"tokenCost",
									"tokens"
								]
							}
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Variable",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":672,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"vhHXW-1",
			"id":"puP5M",
			"index":5,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"additionalProperties":false,
									"type":[
										"object",
										"string",
										"number",
										"boolean",
										"integer"
									],
									"properties":{}
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray"
				},
				"ua:title":"visited",
				"ua:list_type":"STRING"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"visited",
							"disableActions":true,
							"items":{
								"type":"string"
							}
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":439,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"vhHXW-1",
			"id":"n_Ok027",
			"index":6,
			"inputs":{
				"filters":[
					{
						"property":"{{ __ENV__.outputs.read_traces_from_e_traces }}",
						"filter":{
							"operator":"EQUAL",
							"value":"true"
						}
					},
					{
						"property":"{{ __ENV__.outputs.read_traces_from_e_traces }}",
						"filter":{
							"operator":"MISSING"
						}
					}
				],
				"operator":"OR"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"additional":{
				"xsdSchemaConfig":{}
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":58,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_Ok027@vhHXW-1@y",
			"id":"njg21",
			"index":7,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[
						"sqlQuery"
					],
					"properties":{
						"sqlQuery":{
							"type":"string",
							"title":"Sql Query"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"required":[
						"caseId"
					],
					"properties":{
						"caseId":{
							"type":"string",
							"title":"Case Id"
						}
					}
				},
				"code":"String generateQuery(caseId) {\n    return \"SELECT \" +\n           \"    _pr_caseId AS caseId, \" +\n           \"    _pr_aiAgentId AS aiAgentId, \" +\n           \"    _pr_modelId AS modelId, \" +\n           \"    _pr_outputToken AS outputToken, \" +\n           \"    _pr_cost AS cost, \" +\n           \"    _pr_executionInstanceId AS executionInstanceId, \" +\n           \"    _pr_parent AS parent, \" +\n           \"    _pr_provider AS provider, \" +\n           \"    _pr_messageId AS messageId, \" +\n           \"    _pr_userId AS userId, \" +\n           \"    _pr_llmTimeTaken AS llmTimeTaken, \" +\n           \"    _pr_currentType AS currentType, \" +\n           \"    _pr_finish_reason AS finishReason, \" +\n           \"    _pr_inputTokenCost AS inputTokenCost, \" +\n           \"    _pr_outputTokenCost AS outputTokenCost, \" +\n           \"    _pr_rootExecutionId AS rootExecutionId, \" +\n           \"    _pr_parentExecutionId AS parentExecutionId, \" +\n           \"    _pr_toolName AS toolName, \" +\n           \"    _pr_output AS prOutput, \" +\n           \"    _pr_inputToken AS inputToken, \" +\n           \"    _pr_llmErrorType AS llmErrorType, \" +\n           \"    _pr_fromAutomationId AS fromAutomationId, \" +\n           \"    _pr_topicName AS topicName, \" +\n           \"    _pr_startTime AS startTime, \" +\n           \"    _pr_input AS prInput \" +\n           \"FROM ENTITY_e_traces \" +\n           \"WHERE _pr_messageId IS NOT NULL \" +\n           \"  AND _pr_caseId = '\" + caseId + \"' \" +\n           \"  AND _pr_fromAutomationId IN ( \" +\n            \"      '6851442f9e30586f552a6d73' , \"+\n            \"       '67df12719fa26d792211be4f', \"+\n           \"       '66ac70650f725f5b425d12d8', \" +\n           \"       '67933cc866e1f1098aa02c39', \" +\n           \"       '66b32227db0c6546b93d3acc', \" +\n           \"       '66a1e74accc70b77f9bf0308', \" +\n           \"       '66b356891a78c401cb586890', \" +\n           \"       '67e6651efd3591529146b261', \" +\n           \"       '67e4346d4718117333c7ee9a', \" +\n           \"       '66b3353e1a78c401cb583431', \" +\n           \"       '679c6521a6583456a7198e97', \" +\n           \"       '68206abcccc45f469e288de0', \" +\n           \"       '6853d10e492bca4185ba983d' \" +\n           \"  )\";\n}\n\ndef sqlQuery = generateQuery(caseId)\n\nreturn [sqlQuery: sqlQuery]",
				"compile_static":false,
				"isAsync":false,
				"captureStdOutput":false,
				"parameters":{
					"caseId":"{{ 3iNEX.outputs.caseId }}"
				}
			},
			"skip":false,
			"subTitle":"Generate SQL",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"additional":{
				"xsdSchemaConfig":{
					"root":{}
				}
			},
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":18,
				"resourceName":"analytics_by_unifyapps_execute_query",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_Ok027@vhHXW-1@y",
			"id":"dFTNb",
			"index":8,
			"inputs":{
				"outputSchema":{
					"type":"object",
					"properties":{
						"columns":{
							"type":"object",
							"properties":{
								"caseId":{
									"type":"string",
									"title":"caseId"
								},
								"aiAgentId":{
									"type":"string",
									"title":"aiAgentId"
								},
								"modelId":{
									"type":"string",
									"title":"modelId"
								},
								"intputToken":{
									"type":"integer",
									"title":"intputToken"
								},
								"outputToken":{
									"type":"integer",
									"title":"outputToken"
								},
								"cost":{
									"type":"number",
									"title":"cost"
								},
								"executionInstanceId":{
									"type":"string",
									"title":"executionInstanceId"
								},
								"parent":{
									"type":"string",
									"title":"parent"
								},
								"provider":{
									"type":"string",
									"title":"provider"
								},
								"messageId":{
									"type":"string",
									"title":"messageId"
								},
								"userId":{
									"type":"string",
									"title":"userId"
								},
								"llmTimeTaken":{
									"type":"number",
									"title":"llmTimeTaken"
								},
								"currentType":{
									"type":"string",
									"title":"currentType"
								},
								"finishReason":{
									"type":"string",
									"title":"finishReason"
								},
								"inputTokenCost":{
									"type":"number",
									"title":"inputTokenCost"
								},
								"outputTokenCost":{
									"type":"number",
									"title":"outputTokenCost"
								},
								"rootExecutionId":{
									"type":"string",
									"title":"rootExecutionId"
								},
								"parentExecutionId":{
									"type":"string",
									"title":"parentExecutionId"
								},
								"toolName":{
									"type":"string",
									"title":"toolName"
								},
								"prOutput":{
									"type":"string",
									"title":"prOutput"
								},
								"inputToken":{
									"type":"integer",
									"title":"inputToken"
								},
								"llmErrorType":{
									"type":"string",
									"title":"llmErrorType"
								},
								"fromAutomationId":{
									"type":"string",
									"title":"fromAutomationId"
								},
								"topicName":{
									"type":"string",
									"title":"topicName"
								},
								"startTime":{
									"type":"integer",
									"title":"startTime"
								},
								"prInput":{
									"type":"object",
									"properties":{},
									"title":"prInput",
									"additionalProperties":false,
									"required":[]
								}
							},
							"title":"columns",
							"additionalProperties":false
						}
					},
					"additionalProperties":false
				},
				"query":"{{ njg21.outputs.result.sqlQuery }}",
				"group":"PLATFORM"
			},
			"skip":false,
			"subTitle":"Execute SQL",
			"title":"Execute Analytics SQL Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"loop",
				"resourceVersion":301,
				"resourceName":"loop_for_each",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_Ok027@vhHXW-1@y",
			"id":"FW69U",
			"index":9,
			"inputs":{
				"repeatMode":"SINGLE",
				"listSource":"{{ dFTNb.outputs.objects }}",
				"captureIterations":false
			},
			"skip":false,
			"subTitle":"Loop",
			"title":"For loop",
			"type":"LOOP"
		},
		{
			"additional":{
				"xsdSchemaConfig":{}
			},
			"context":{
				"appName":"utility_by_unifyapps",
				"resourceVersion":297,
				"resourceName":"utility_by_unifyapps_to_json_object",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"FW69U@n_Ok027@vhHXW-1@y@l",
			"id":"uJu1r",
			"index":10,
			"inputs":{
				"jsonSchema":{
					"type":"object",
					"properties":{
						"agentId":{
							"type":"string",
							"title":"agentId"
						},
						"caseId":{
							"type":"string",
							"title":"caseId"
						},
						"input":{
							"type":"object",
							"title":"input"
						},
						"inputTokens":{
							"type":"integer",
							"title":"inputTokens"
						},
						"messageId":{
							"type":"string",
							"title":"messageId"
						},
						"output":{
							"type":"string",
							"title":"output"
						},
						"outputTokens":{
							"type":"integer",
							"title":"outputTokens"
						},
						"parent":{
							"type":"string",
							"title":"parent"
						},
						"startTime":{
							"type":"integer",
							"title":"startTime"
						},
						"step":{
							"type":"string",
							"title":"step"
						},
						"totalCost":{
							"type":"integer",
							"title":"totalCost"
						}
					},
					"additionalProperties":false
				},
				"jsonString":"{{ FW69U.outputs.item.columns.prInput }}"
			},
			"skip":false,
			"subTitle":"Utility",
			"title":"Deserialise string to JSON object",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":291,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"FW69U@n_Ok027@vhHXW-1@y@l",
			"id":"jPSc2",
			"index":11,
			"inputs":{
				"filters":[
					{
						"property":"{{ uJu1r.outputs.result.messageId }}",
						"filter":{
							"operator":"EXISTS"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":623,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"jPSc2@FW69U@n_Ok027@vhHXW-1@y@l@y",
			"id":"7frlW",
			"index":12,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"result":{
							"type":"boolean",
							"title":"Result"
						}
					},
					"additionalProperties":false,
					"required":[
						"result"
					]
				},
				"input":{
					"type":"object",
					"properties":{
						"visited":{
							"type":"array",
							"items":{
								"type":"string"
							},
							"title":"Visited"
						},
						"traceId":{
							"type":"string",
							"title":"Trace Id"
						}
					},
					"additionalProperties":false,
					"required":[
						"visited",
						"traceId"
					]
				},
				"compile_static":false,
				"code":"def result = false\nif (binding.hasVariable('visited')) {\n    def visited = binding.getVariable('visited')\n    if (visited instanceof Collection) {\n        result = visited.contains(traceId)\n    }\n}\nreturn [result: result]\n",
				"parameters":{
					"visited":{
						"source":"{{ puP5M.outputs.items }}",
						"ua:type":"mappedArray",
						"items":"{{ puP5M.outputs.items[0] }}"
					},
					"traceId":"{{ FW69U.outputs.item.columns.messageId }}"
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":578,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"jPSc2@FW69U@n_Ok027@vhHXW-1@y@l@y",
			"id":"7nYCD",
			"index":13,
			"inputs":{
				"filters":[
					{
						"property":"{{ 7frlW.outputs.result.result }}",
						"filter":{
							"operator":"EQUAL",
							"value":"true"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":623,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"7nYCD@jPSc2@FW69U@n_Ok027@vhHXW-1@y@l@y@n",
			"id":"b7S1e",
			"index":14,
			"inputs":{
				"itemToAdd":"{{ FW69U.outputs.item.columns.messageId }}",
				"insertLocation":"END",
				"listName":"{{ puP5M.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":299,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"jPSc2@FW69U@n_Ok027@vhHXW-1@y@l@y",
			"id":"vUKrY",
			"index":15,
			"inputs":{
				"itemToAdd":{
					"tokens":"=SUM({{ FW69U.outputs.item.columns.inputToken }},{{ FW69U.outputs.item.columns.outputToken }})",
					"traceId":"{{ FW69U.outputs.item.columns.messageId }}",
					"tokenCost":"=SUM({{ FW69U.outputs.item.columns.inputTokenCost }},{{ FW69U.outputs.item.columns.outputTokenCost }})"
				},
				"insertLocation":"END",
				"listName":"{{ 3yG5L.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Variable",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"additional":{
				"xsdSchemaConfig":{}
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":58,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_Ok027@vhHXW-1@n",
			"id":"_6J13W",
			"index":16,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"sqlQuery":{
							"type":"string",
							"title":"Sql Query"
						}
					},
					"additionalProperties":false,
					"required":[
						"sqlQuery"
					]
				},
				"input":{
					"type":"object",
					"properties":{
						"caseId":{
							"type":"string",
							"title":"Case Id"
						},
						"startTime":{
							"type":"number",
							"title":"Start Time"
						},
						"endTime":{
							"type":"number",
							"title":"End Time"
						}
					},
					"additionalProperties":false,
					"required":[
						"caseId",
						"startTime",
						"endTime"
					]
				},
				"compile_static":false,
				"code":"String generateQuery(String caseId, Long startTime, Long endTime) {\n    return \"SELECT wne.entryTime, wne.inputs, wne.id, wne.executionInstanceId, wne.outputs, we.startNodeOutput \" +\n           \"FROM WORKFLOW_NODE_EXECUTION wne \" +\n           \"JOIN WORKFLOW_EXECUTION we ON wne.executionInstanceId = we.id \" +\n           \"WHERE wne.currentNodeId IN ('b66uk') \" +\n           \"AND wne.workflowId IN ('66ac70650f725f5b425d12d8', '67e4346d4718117333c7ee9a') \" +\n           \"AND we.workflowId IN ('66ac70650f725f5b425d12d8', '67e4346d4718117333c7ee9a') \" +\n           \"AND messageId IS NOT NULL \" +\n           \"AND caseId = '\" + caseId + \"' \" +\n           \"AND wne.entryTime >= \" + startTime + \" AND wne.entryTime <= \" + endTime + \" \" +\n           \"ORDER BY entryTime ASC LIMIT 500;\";\n}\n\ndef sqlQuery = generateQuery(caseId, startTime, endTime)\n\nreturn [sqlQuery: sqlQuery]",
				"isAsync":false,
				"parameters":{
					"caseId":"{{ 3iNEX.outputs.caseId }}",
					"startTime":"{{ KQ4fW.outputs.createdTime }}",
					"endTime":"{{ KQ4fW.outputs.createdTime }}"
				}
			},
			"skip":false,
			"subTitle":"Generate SQL",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":18,
				"resourceName":"analytics_by_unifyapps_execute_query",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_Ok027@vhHXW-1@n",
			"id":"_WxY0C",
			"index":17,
			"inputs":{
				"outputSchema":{
					"type":"object",
					"properties":{
						"columns":{
							"type":"object",
							"properties":{
								"outputs":{
									"type":"string",
									"title":"Outputs"
								},
								"startNodeOutput":{
									"type":"string",
									"title":"Start Node Output"
								},
								"inputs":{
									"type":"string",
									"title":"Inputs"
								}
							},
							"title":"columns",
							"additionalProperties":false,
							"required":[
								"outputs",
								"startNodeOutput",
								"inputs"
							]
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"query":"{{ _6J13W.outputs.result.sqlQuery }}",
				"group":"PLATFORM"
			},
			"skip":false,
			"subTitle":"Execute SQL",
			"title":"Execute Analytics SQL Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"loop",
				"resourceVersion":301,
				"resourceName":"loop_for_each",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_Ok027@vhHXW-1@n",
			"id":"_Fd7f1",
			"index":18,
			"inputs":{
				"repeatMode":"SINGLE",
				"listSource":"{{ _WxY0C.outputs.objects }}",
				"captureIterations":false
			},
			"skip":false,
			"subTitle":"Loop",
			"title":"For loop",
			"type":"LOOP"
		},
		{
			"additional":{
				"xsdSchemaConfig":{}
			},
			"context":{
				"appName":"utility_by_unifyapps",
				"resourceVersion":297,
				"resourceName":"utility_by_unifyapps_to_json_object",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_Fd7f1@n_Ok027@vhHXW-1@n@l",
			"id":"_x5rTv",
			"index":19,
			"inputs":{
				"jsonSchema":{
					"type":"object",
					"additionalProperties":false,
					"properties":{
						"agentId":{
							"type":"string",
							"title":"agentId"
						},
						"caseId":{
							"type":"string",
							"title":"caseId"
						},
						"input":{
							"type":"object",
							"title":"input"
						},
						"inputTokens":{
							"type":"integer",
							"title":"inputTokens"
						},
						"messageId":{
							"type":"string",
							"title":"messageId"
						},
						"output":{
							"type":"string",
							"title":"output"
						},
						"outputTokens":{
							"type":"integer",
							"title":"outputTokens"
						},
						"parent":{
							"type":"string",
							"title":"parent"
						},
						"startTime":{
							"type":"integer",
							"title":"startTime"
						},
						"step":{
							"type":"string",
							"title":"step"
						},
						"totalCost":{
							"type":"integer",
							"title":"totalCost"
						}
					}
				},
				"jsonString":"{{ _Fd7f1.outputs.item.columns.inputs }}"
			},
			"skip":false,
			"subTitle":"Utility",
			"title":"Deserialise string to JSON object",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"utility_by_unifyapps",
				"resourceVersion":297,
				"resourceName":"utility_by_unifyapps_to_json_object",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_Fd7f1@n_Ok027@vhHXW-1@n@l",
			"id":"_MDLtQ",
			"index":20,
			"inputs":{
				"jsonSchema":{
					"type":"object",
					"additionalProperties":false,
					"properties":{
						"finish_reason":{
							"type":"string",
							"title":"finish_reason"
						},
						"llmResponse":{
							"type":"string",
							"title":"llmResponse"
						},
						"success":{
							"type":"boolean",
							"title":"success"
						},
						"caseId":{
							"type":"string",
							"title":"caseId"
						},
						"outputTokenCost":{
							"type":"number",
							"title":"outputTokenCost"
						},
						"inputTokens":{
							"type":"integer",
							"title":"inputTokens"
						},
						"outputTokens":{
							"type":"integer",
							"title":"outputTokens"
						},
						"inputTokenCost":{
							"type":"number",
							"title":"inputTokenCost"
						},
						"tokensUsed":{
							"type":"integer",
							"title":"tokensUsed"
						}
					}
				},
				"jsonString":"{{ _Fd7f1.outputs.item.columns.outputs }}"
			},
			"skip":false,
			"subTitle":"Utility",
			"title":"Deserialise string to JSON object",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":291,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_Fd7f1@n_Ok027@vhHXW-1@n@l",
			"id":"_ajleK",
			"index":21,
			"inputs":{
				"filters":[
					{
						"property":"{{ _x5rTv.outputs.result.messageId }}",
						"filter":{
							"operator":"EXISTS"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":623,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ajleK@_Fd7f1@n_Ok027@vhHXW-1@n@l@y",
			"id":"_5fPk5",
			"index":22,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"result":{
							"type":"boolean",
							"title":"Result"
						}
					},
					"additionalProperties":false,
					"required":[
						"result"
					]
				},
				"input":{
					"type":"object",
					"properties":{
						"visited":{
							"type":"array",
							"items":{
								"type":"string"
							},
							"title":"Visited"
						},
						"traceId":{
							"type":"string",
							"title":"Trace Id"
						}
					},
					"additionalProperties":false,
					"required":[
						"visited",
						"traceId"
					]
				},
				"compile_static":false,
				"code":"def result = false\nif (binding.hasVariable('visited')) {\n    def visited = binding.getVariable('visited')\n    if (visited instanceof Collection) {\n        result = visited.contains(traceId)\n    }\n}\nreturn [result: result]\n",
				"parameters":{
					"visited":{
						"source":"{{ puP5M.outputs.items }}",
						"ua:type":"mappedArray",
						"items":"{{ puP5M.outputs.items[0] }}"
					},
					"traceId":"{{ _x5rTv.outputs.result.messageId }}"
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":578,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ajleK@_Fd7f1@n_Ok027@vhHXW-1@n@l@y",
			"id":"_5vb49",
			"index":23,
			"inputs":{
				"filters":[
					{
						"property":"{{ _5fPk5.outputs.result.result }}",
						"filter":{
							"operator":"EQUAL",
							"value":"true"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":623,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_5vb49@_ajleK@_Fd7f1@n_Ok027@vhHXW-1@n@l@y@n",
			"id":"_6LcRN",
			"index":24,
			"inputs":{
				"itemToAdd":"{{ _x5rTv.outputs.result.messageId }}",
				"insertLocation":"END",
				"listName":"{{ puP5M.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":299,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ajleK@_Fd7f1@n_Ok027@vhHXW-1@n@l@y",
			"id":"_rOX45",
			"index":25,
			"inputs":{
				"itemToAdd":{
					"tokens":"=SUM({{ _x5rTv.outputs.result.inputTokens }},{{ _x5rTv.outputs.result.outputTokens }})",
					"tokenCost":"{{ _x5rTv.outputs.result.totalCost }}",
					"traceId":"{{ _x5rTv.outputs.result.messageId }}"
				},
				"insertLocation":"END",
				"listName":"{{ 3yG5L.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Variable",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":672,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"vhHXW-1",
			"id":"IzzSw",
			"index":26,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"additionalProperties":false,
									"type":[
										"object",
										"string",
										"number",
										"boolean",
										"integer"
									],
									"properties":{}
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray",
					"source":"{{ puP5M.outputs.items }}",
					"items":"{{ puP5M.outputs.items[0] }}"
				},
				"ua:title":"fanMessageIds",
				"ua:list_type":"STRING"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"fanMessageIds",
							"disableActions":true,
							"items":{
								"type":"string"
							}
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":303,
				"resourceName":"storage_by_unifyapps_fetch_records",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"vhHXW-1",
			"id":"vzNbB",
			"index":27,
			"inputs":{
				"triggerInputCondition":{
					"filters":[
						{
							"property":"properties_additional_parentMessageId",
							"filter":{
								"operator":"IN",
								"value":"{{ IzzSw.outputs.items }}"
							}
						},
						{
							"filters":[
								{
									"property":"properties_additional_temporaryMessage",
									"filter":{
										"operator":"EQUAL",
										"value":"false"
									}
								},
								{
									"property":"properties_additional_temporaryMessage",
									"filter":{
										"operator":"MISSING"
									}
								}
							],
							"operator":"OR"
						},
						{
							"property":"properties_type",
							"filter":{
								"operator":"NOT_EQUAL",
								"value":"fan"
							}
						}
					],
					"operator":"AND"
				},
				"object_type":"service_hub_message",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"sortBy":[
					{
						"field":"cTm",
						"order":"DESC"
					}
				],
				"translationsOption":"DEFAULT",
				"page":{
					"paginateBy":"OFFSET",
					"limit":200,
					"offset":0
				},
				"numberOfRecordsToFetch":"MULTIPLE",
				"readThroughSessionVariables":false,
				"includeTotalCount":false
			},
			"skip":false,
			"subTitle":"Storage",
			"title":"Fetch records",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":290,
				"resourceName":"storage_by_unifyapps_get_records_by_ids",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"vhHXW-1",
			"id":"xORbN",
			"index":28,
			"inputs":{
				"object_type":"service_hub_message",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"ids":{
					"source":"{{ 3yG5L.outputs.items }}",
					"ua:type":"mappedArray",
					"items":"{{ 3yG5L.outputs.items[0].traceId }}"
				},
				"translationsOption":"DEFAULT",
				"readThroughSessionVariables":false
			},
			"skip":false,
			"subTitle":"Storage",
			"title":"Get records by IDs",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":706,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"vhHXW-1",
			"id":"vBMPP",
			"index":29,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"additionalProperties":false,
									"type":[
										"object",
										"string",
										"number",
										"boolean",
										"integer"
									],
									"properties":{
										"result":{
											"type":"object",
											"properties":{},
											"additionalProperties":false,
											"title":"Result"
										}
									},
									"required":[
										"result"
									]
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray"
				},
				"ua:title":"response",
				"ua:list_type":"OBJECT"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"response",
							"disableActions":true,
							"items":{
								"type":"object",
								"properties":{
									"result":{
										"type":"object",
										"properties":{},
										"additionalProperties":false,
										"title":"Result"
									}
								},
								"required":[
									"result"
								]
							}
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":612,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"vhHXW-1",
			"id":"TU9se",
			"index":30,
			"inputs":{
				"filters":[
					{
						"property":"=LEN({{ xORbN.outputs.objects }})",
						"filter":{
							"operator":"GT",
							"value":"0"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.parameters.fanMessages.items.streamCompletionTime",
					"root.parameters.brandMessages.items.streamCompletionTime"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":300,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"TU9se@vhHXW-1@y",
			"id":"XlqC3",
			"index":31,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[
						"result"
					],
					"properties":{
						"result":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"id":{
										"type":"string",
										"title":"Id"
									},
									"latency":{
										"type":"number",
										"title":"Latency"
									}
								},
								"additionalProperties":false,
								"required":[
									"id",
									"latency"
								]
							},
							"title":"Result"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"required":[
						"brandMessages",
						"fanMessages"
					],
					"properties":{
						"brandMessages":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"parentMessageId":{
										"type":"string",
										"title":"Parent Message Id"
									},
									"modifiedTime":{
										"type":"number",
										"title":"Modified Time"
									},
									"streamCompletionTime":{
										"type":"integer",
										"title":"Stream Completion Time"
									}
								},
								"additionalProperties":false,
								"required":[
									"parentMessageId",
									"modifiedTime"
								]
							},
							"title":"Brand Messages"
						},
						"fanMessages":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"messageId":{
										"type":"string",
										"title":"Message Id"
									},
									"createdTime":{
										"type":"number",
										"title":"Created Time"
									}
								},
								"additionalProperties":false,
								"required":[
									"messageId",
									"createdTime"
								]
							},
							"title":"Fan Messages"
						}
					}
				},
				"code":"def fanMessageIdVsBrandMessage = [:]\n\nbrandMessages = (binding.hasVariable('brandMessages') && brandMessages instanceof List) ? brandMessages : [] \nbrandMessages.each { brandMessage ->\n    def fanMessageId = brandMessage.parentMessageId\n    if (!fanMessageIdVsBrandMessage.containsKey(fanMessageId)) {\n        fanMessageIdVsBrandMessage[fanMessageId] = brandMessage\n    }\n}\n\ndef result = []\nfanMessages = (binding.hasVariable('fanMessages') && fanMessages instanceof List) ? fanMessages : [] \nfanMessages.each { fanMessage ->\n    def fanMessageId = fanMessage.messageId\n    def brandMessage = fanMessageIdVsBrandMessage[fanMessageId]\n\n    if (brandMessage) {\n        def endTime\n        if (brandMessage.containsKey('streamCompletionTime')) {\n            endTime = brandMessage.streamCompletionTime\n        } else {\n            endTime = brandMessage.modifiedTime\n        }\n\n        if (endTime != null && fanMessage.createdTime != null) {\n            def latency = endTime - fanMessage.createdTime\n            result << [id: fanMessageId, latency: latency]\n        }\n    }\n}\n\nreturn ['result': result]\n",
				"compile_static":false,
				"captureStdOutput":false,
				"parameters":{
					"brandMessages":{
						"source":"{{ vzNbB.outputs.objects }}",
						"ua:type":"mappedArray",
						"items":{
							"parentMessageId":"{{ vzNbB.outputs.objects[0].properties.additional.parentMessageId }}",
							"modifiedTime":"{{ vzNbB.outputs.objects[0].modifiedTime }}",
							"streamCompletionTime":"{{ vzNbB.outputs.objects[0].properties.additional.streamingCompletionTime }}"
						}
					},
					"fanMessages":{
						"source":"{{ xORbN.outputs.objects }}",
						"ua:type":"mappedArray",
						"items":{
							"messageId":"{{ xORbN.outputs.objects[0].id }}",
							"createdTime":"{{ xORbN.outputs.objects[0].createdTime }}"
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Code",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":300,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"TU9se@vhHXW-1@y",
			"id":"UYgSw",
			"index":32,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"traceInfos":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"Trace Infos"
						}
					},
					"additionalProperties":false,
					"required":[
						"traceInfos"
					]
				},
				"input":{
					"type":"object",
					"properties":{
						"latencyInfo":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"id":{
										"type":"string",
										"title":"Id"
									},
									"latency":{
										"type":"number",
										"title":"Latency"
									}
								},
								"additionalProperties":false,
								"required":[
									"id",
									"latency"
								]
							},
							"title":"Latency Info"
						},
						"traceInfos":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"Trace Infos"
						}
					},
					"additionalProperties":false,
					"required":[
						"latencyInfo",
						"traceInfos"
					]
				},
				"compile_static":false,
				"code":"def result = []\n\nif (binding.hasVariable('latencyInfo') && binding.hasVariable('traceInfos')) {\n    def map = [:]\n\n    traceInfos.each { traceInfo ->\n        def id = traceInfo.traceId\n        def value = map.get(id)\n        if (!value) {\n            map[id] = [\n                traceId  : id,\n                tokens   : traceInfo.tokens ?: 0,\n                tokenCost: traceInfo.tokenCost ?: 0\n            ]\n        } else {\n            map[id].tokenCost += traceInfo.tokenCost\n            map[id].tokens += traceInfo.tokens\n        }\n    }\n\n    latencyInfo.each { info ->\n        def value = map[info.id]\n        if (value) {\n            value['latency'] = info.latency\n            result << value\n        }\n    }\n}\n\nreturn ['traceInfos': result]\n",
				"parameters":{
					"latencyInfo":{
						"source":"{{ XlqC3.outputs.result.result }}",
						"ua:type":"mappedArray",
						"items":{
							"id":"{{ XlqC3.outputs.result.result[0].id }}",
							"latency":"{{ XlqC3.outputs.result.result[0].latency }}"
						}
					},
					"traceInfos":{
						"source":"{{ 3yG5L.outputs.items }}",
						"ua:type":"mappedArray",
						"items":"{{ 3yG5L.outputs.items[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Code",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":631,
				"resourceName":"variable_by_unifyapps_add_items_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"TU9se@vhHXW-1@y",
			"id":"GFzTm",
			"index":33,
			"inputs":{
				"insertLocation":"END",
				"itemsToAdd":{
					"ua:type":"mappedArray",
					"source":"{{ UYgSw.outputs.result.traceInfos }}",
					"items":{
						"result":"{{ UYgSw.outputs.result.traceInfos[0] }}"
					}
				},
				"listName":"{{ vBMPP.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Add items to list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":302,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"vhHXW-1",
			"id":"7o210",
			"index":34,
			"inputs":{
				"result":{
					"result":{
						"ua:type":"mappedArray",
						"source":"{{ vBMPP.outputs.items }}",
						"items":"{{ vBMPP.outputs.items[0].result }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":311,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":true,
	"tags":[
		"AI Agent"
	],
	"version":132
}