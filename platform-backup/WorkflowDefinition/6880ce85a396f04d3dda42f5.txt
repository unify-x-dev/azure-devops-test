{
	"appsUsed":[
		"storage_by_unifyapps"
	],
	"createdTime":1753445879504,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1760296174888,
		"deployedBy":-1,
		"deployedDefinitionId":"68ebfcee0c3d19149a9e3470",
		"status":"DEPLOYED",
		"version":21,
		"workflowVersion":44
	},
	"edges":[
		{
			"fromNodeId":"n_5xqBS",
			"priority":0,
			"skip":false,
			"toNodeId":"n_EypD4",
			"type":"next"
		},
		{
			"fromNodeId":"n_EypD4",
			"priority":0,
			"skip":false,
			"toNodeId":"n_Po1cT",
			"type":"next"
		},
		{
			"fromNodeId":"n_Po1cT",
			"priority":0,
			"skip":false,
			"toNodeId":"n_gNx2V",
			"type":"next"
		}
	],
	"grants":{
		"configs":[
			{
				"permissions":[
					"V"
				],
				"principalType":"GLOBAL"
			}
		]
	},
	"id":"6880ce85a396f04d3dda42f5",
	"lastModifiedBy":0,
	"lcName":"[debug agent] fetch tool calls",
	"modifiedTime":1761722691163,
	"name":"[Debug Agent] Fetch Tool Calls",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceVersion":445,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_titZn-1",
			"id":"n_5xqBS",
			"index":1,
			"inputs":{
				"result":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"toolCalls":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"toolName":{
										"type":"string",
										"title":"Tool Name"
									},
									"toolExecutionStatus":{
										"type":"string",
										"title":"Tool Execution Status"
									},
									"executionLink":{
										"type":"string",
										"title":"Execution Link"
									},
									"executionTime":{
										"type":"string",
										"title":"Execution Time"
									},
									"input":{
										"type":"object",
										"properties":{},
										"additionalProperties":false,
										"title":"Input"
									},
									"output":{
										"type":"string",
										"title":"Output"
									}
								},
								"additionalProperties":false,
								"required":[]
							},
							"title":"Tool Calls"
						}
					}
				},
				"setup":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"domain":{
							"type":"string",
							"title":"Domain"
						},
						"caseId":{
							"type":"string",
							"title":"Case Id"
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger via automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":518,
				"resourceName":"storage_by_unifyapps_fetch_records",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_titZn-1",
			"id":"n_EypD4",
			"index":2,
			"inputs":{
				"triggerInputCondition":{
					"filters":[
						{
							"property":"properties_caseId",
							"filter":{
								"operator":"EQUAL",
								"value":"{{ n_5xqBS.outputs.caseId }}"
							}
						}
					],
					"operator":"AND"
				},
				"object_type":"service_hub_message",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"sortBy":[
					{
						"field":"cTm",
						"order":"ASC"
					}
				],
				"page":{
					"paginateBy":"OFFSET",
					"limit":1500,
					"offset":0
				},
				"numberOfRecordsToFetch":"MULTIPLE",
				"readThroughSessionVariables":false,
				"includeTotalCount":true
			},
			"skip":false,
			"subTitle":"Fetch Tool Calls from Service Hub Message",
			"title":"Fetch records",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.parameters.tools.items.toolName",
					"root.parameters.tools.items.toolInput",
					"root.parameters.tools.items.toolOutput",
					"root.parameters.tools.items.status",
					"root.parameters.tools.items.executionStartTime",
					"root.parameters.tools.items.agentExecutorCurrentExecutionId"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":450,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_titZn-1",
			"id":"n_Po1cT",
			"index":3,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"processedTools":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"toolName":{
										"type":"string",
										"title":"Tool Name"
									},
									"status":{
										"type":"string",
										"title":"Status"
									},
									"executionLink":{
										"type":"string",
										"title":"Execution Link"
									},
									"executionStartTime":{
										"type":"string",
										"title":"Execution Start Time"
									},
									"toolInput":{
										"type":"object",
										"properties":{},
										"additionalProperties":false,
										"title":"Tool Input"
									},
									"toolOutput":{
										"type":"string",
										"title":"Tool Output"
									}
								},
								"additionalProperties":false,
								"required":[]
							},
							"title":"Processed Tools"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"tools":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"toolName":{
										"type":"string",
										"title":"Tool Name"
									},
									"toolInput":{
										"type":"object",
										"properties":{},
										"additionalProperties":false,
										"title":"Tool Input"
									},
									"toolOutput":{
										"type":"string",
										"title":"Tool Output"
									},
									"status":{
										"type":"boolean",
										"title":"Status"
									},
									"executionStartTime":{
										"type":"integer",
										"title":"Execution Start Time"
									},
									"agentExecutorCurrentExecutionId":{
										"type":"string",
										"title":"Agent Executor Current Execution Id"
									}
								},
								"additionalProperties":false,
								"required":[]
							},
							"title":"Tools"
						},
						"domain":{
							"type":"string",
							"title":"Domain"
						}
					}
				},
				"compile_static":false,
				"code":"import java.text.SimpleDateFormat\n\ndef sdf = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\")\nsdf.setTimeZone(TimeZone.getTimeZone(\"Asia/Kolkata\"))\n\nif (!binding.hasVariable('tools')) {\n    return [\"processedTools\": []]\n}\n\ndef processedTools = tools.collect { tool ->\n    if (!tool.toolName) return null  // ignore if no toolName\n\n    def entry = [\n        toolName: tool.toolName\n    ]\n\n    // Add optional fields only if present\n    ['toolInput', 'toolOutput', 'status', 'executionStartTime'].each { key ->\n        if (tool.containsKey(key)) {\n            if (key == 'status') {\n                def statusVal = tool[key]\n                entry[key] = statusVal ? \"COMPLETED\" : \"FAILED\"\n            } else if (key == 'executionStartTime') {\n                try {\n                    // Assuming timestamp is in milliseconds\n                    entry[key] = sdf.format(new Date(tool[key].toLong()))\n                } catch (Exception e) {\n                    entry[key] = null\n                }\n            } else {\n                entry[key] = tool[key]\n            }\n        }\n    } // <- closing brace for each loop\n\n    if (tool.containsKey('agentExecutorCurrentExecutionId') && tool.agentExecutorCurrentExecutionId) {\n        def executionId = tool.agentExecutorCurrentExecutionId\n        entry.executionLink = \"https://\" + domain + \"/p/0/automations/67850d225384a9541846f5b9/runs/\" + executionId\n    }\n\n    return entry\n}.findAll { it != null }  // remove nulls\n\nreturn [\"processedTools\": processedTools]",
				"parameters":{
					"domain":"{{ n_5xqBS.outputs.domain }}",
					"tools":{
						"source":"{{ n_EypD4.outputs.objects }}",
						"ua:type":"mappedArray",
						"items":{
							"toolName":"{{ n_EypD4.outputs.objects[0].properties.content.agentResponse.toolUseDetails.toolName }}",
							"toolInput":"{{ n_EypD4.outputs.objects[0].properties.content.agentResponse.toolUseDetails.toolInput }}",
							"toolOutput":"{{ n_EypD4.outputs.objects[0].properties.content.agentResponse.toolUseDetails.toolOutput }}",
							"status":"{{ n_EypD4.outputs.objects[0].properties.content.agentResponse.toolUseDetails.toolExecutionStatus }}",
							"agentExecutorCurrentExecutionId":"{{ n_EypD4.outputs.objects[0].properties.content.agentResponse.toolUseDetails.agentExecutorExecutionId }}",
							"executionStartTime":"{{ n_EypD4.outputs.objects[0].createdTime }}"
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":455,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_titZn-1",
			"id":"n_gNx2V",
			"index":4,
			"inputs":{
				"result":{
					"toolCalls":{
						"ua:type":"mappedArray",
						"items":{
							"toolName":"{{ n_Po1cT.outputs.result.processedTools[0].toolName }}",
							"toolExecutionStatus":"{{ n_Po1cT.outputs.result.processedTools[0].status }}",
							"executionLink":"{{ n_Po1cT.outputs.result.processedTools[0].executionLink }}",
							"executionTime":"{{ n_Po1cT.outputs.result.processedTools[0].executionStartTime }}",
							"input":"{{ n_Po1cT.outputs.result.processedTools[0].toolInput }}",
							"output":"{{ n_Po1cT.outputs.result.processedTools[0].toolOutput }}"
						},
						"source":"{{ n_Po1cT.outputs.result.processedTools }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":43069,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":true,
	"tags":[
		
	],
	"version":46
}